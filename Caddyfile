# 
# When ready to launch, modify this configuration with the 
# real domain names. Then, run the command `make public` and 
# choose a load balancer.
#

# wordpress.lb1.nonfiction.ca {
wordpress.lb1.nfweb.ca {

	# reverse_proxy https://wordpress.prod1.nfweb.ca {
  reverse_proxy <%= $(bin/get upstreams); %> {

    # User: <%= $(bin/get upstream_user) %>
    # Password: <%= $(bin/get upstream_password) %>
    header_up Authorization "Basic <% echo $(bin/get upstream_user):$(bin/get upstream_password) | base64 -w0 %>"
    # basicauth * bcrypt <%= $(bin/get app); %> 
    
    header_up WWW-Authenticate 'Basic realm="<%= $(bin/get app); %>"'

    lb_policy uri_hash
  }

}

# Example how to enforce www
# example.com {
#   redir https://www.example.com{uri}
# }
#
# Example how to enforce non-www
# www.example.com {
#   redir https://example.com{uri}
# }
#
# See more here: 
# https://caddyserver.com/docs/caddyfile
